<html ng-app>
<div>
  <h3>הוספת מכירות</h3>
</div>
<form style="max-width: 960px" [formGroup]='salesForm' action="action" (submit)="saveSale()" method="POST"
  class="form-inline">
  <br>

  <span>

    <label for="datesale">מספר אבנים</label>
    <input type="number" min="0" formControlName="num" class="form-control" tabindex="0" (change)="numStonesFunc()"
      id="numStones">
    <!-- <label  *ngIf="salesForm.controls['datesale'].error!=null">גדול </label> -->
  </span>&nbsp; &nbsp;
  <span>

    <label for="datesale"> תאריך מכירה:</label>
    <input type="date" (input)="addEventCalcDate()" class="form-control" formControlName="date" tabindex="1"
      id="datesale">

    <!-- <label  *ngIf="salesForm.controls['datesale'].error!=null">גדול </label> -->
  </span>&nbsp; &nbsp;
  <!-- PaymentsNumber -->
  <span>
    <label for="numOfDate">תנאי תשלום:</label>
    <input type="text" min="0" (input)="addEventCalcDate()" class="form-control" type="number" tabindex="2"
      formControlName="numOfDate" placeholder="מספר ימים" id="numOfDate">
  </span>&nbsp; &nbsp;

  <span>
    <label>תאריך פרעון:</label>
    <input [value]="dateP" type="text" class="form-control" formControlName="date2" placeholder="אוטומטי" id="DueDate"
      disabled="form-check-input">
  </span>&nbsp; &nbsp;
  <span>
    <label for="invoiceNumber">מספר חשבונית:</label>
    <input type="number" min="0" class="form-control" formControlName="invoiceNumber" tabindex="3"
      placeholder="מספר חשבונית" id="invoiceNumber">

  </span>&nbsp; &nbsp;
  <br><br><br><br>
  <div>
    <label class="form-check-label">
      <label>
        <input type="radio" (input)="tableKeyPresent()" id="raw" class="form-check-input" tabindex="4"
          formControlName="rawOrPolished" value="raw">&nbsp;גלם
      </label>
      <label>
        &nbsp;
        <input type="radio" (input)="tableKeyPresent()" class="form-check-input" tabindex="5" value="polished"
          formControlName="rawOrPolished" [checked]="false">&nbsp;מלוטש
      </label>
    </label>
  </div>
  <br>
  <br>
  <br>
  <br><br>

  <table class="table table-bordered" id="saleTable">
    <thead>
      <tr id="header">
        <th>סריה כללית</th>
        <th>סריה פרטית</th>
        <th>שם אבן </th>
        <th>משקל</th>
        <th style="height:5px ;"> מחיר לקראט</th>
        <th>סה"כ</th>
      </tr>
    </thead>  
 <tbody formArrayName="newSaleRow">
      <tr *ngFor="let sale of newSaleRow.controls; let i=index" [formGroupName]="i">
<!-- <td>
          <input style="border: none;" type="text" id="selectSerial" tabindex={{i*5+6}} name="example" list="List"
            [ngModelOptions]="{standalone: true}" [(ngModel)]="selectedSerial" placeholder="בחר"
            (change)="selectedSaleId($event)">
          <datalist id="List">
            <option id="{{s.serialName}}" *ngFor="let s of seriousnessList ;let i=index" [attr.data-value]="s.id"
              [attr.i]="i">{{s.serialName}}
            </option>
          </datalist>
</td> -->
<td>
  <input style="border: none;" type="text" id="selectSerial" tabindex={{i*5+6}} name="example" list="List"
    [ngModelOptions]="{standalone: true}"  formControlName="publicSerialName" placeholder="בחר"
    (change)="selectedSaleId($event,i)">
  <datalist id="List">
    <option id="{{s.serialName}}" *ngFor="let s of seriousnessList ;let i=index" [attr.data-value]="s.id"
      [attr.i]="i">{{s.serialName}}
    </option>
  </datalist>
        </td>
        <td>
          <input formControlName="privateSerialName" type="text" class="input" tabindex={{i*5+7}} >
        </td>

        <td><input  formControlName="stoneName" type="text" class="input"
          tabindex={{i*5+8}}> </td>

        <td><input #wee tabindex={{i*5+9}} (input)="totalPrice[i] = wee.value * pricepercarat.value "
          formControlName="weight" class="input"  min="0" type="number" name="w"> </td>

        <td><input tabindex={{i*5+10}} #pricepercarat (input)="totalPrice[i] = wee.value * pricepercarat.value "
            formControlName="pricePerCarat" class="input"  min="0"
            type="number" classNam="PricePerCarat"> </td>

            <td><input [value]="totalPrice[i]" class="input"></td>
      </tr>
    </tbody>
  </table>
  <label class="error" *ngIf="salesForm.controls.dirty">נא למלא את כל הפרטים.</label><br>
  <div class="modal-footer d-flex">
   <button type="button" (click)="cancel()" class="btn btn-primary" id="cancel">ביטול</button>
   <button type="submit" class="btn btn-primary" id="save"  [disabled]="!salesForm.valid">שמירה</button>
   </div>
</form>
<router-outlet></router-outlet>

</html>